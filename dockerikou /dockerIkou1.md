### ğŸ³Herd ã‹ã‚‰ã€€Laravel + Dockerã¸ãŠå¼•è¶Šã—ï¼ï¼ã€€çˆ†é€Ÿãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ã¾ã§ã®å‰æ‰‹é †

##  Herd -> Dockerã¸ç§»è¡Œã—ãŸç†ç”±
### 1. sqliteã®ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¦ã—ã¾ã†å•é¡Œ
å…ˆæ—¥ã€åŸå› ä¸æ˜ã®ãƒˆãƒ©ãƒ–ãƒ«ã«ã‚ˆã‚Šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå–å¾—ã§ããšã€ã•ã‚‰ã«ãƒ‡ãƒ¼ã‚¿ãŒæ¬ æã™ã‚‹ã¨ã„ã†ä¸å…·åˆã«é­é‡ã—ã¾ã—ãŸã€‚
SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç ´æã‚’ä¿®å¾©ã—ã€å‰Šé™¤ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å¯èƒ½ãªé™ã‚Šå–ã‚Šæˆ»ã™æ–¹æ³•ã‚’æ¢ã—ã¦ãã¦ç›´ã™æ–¹æ³•ã‚’ã‚„ã£ã¦ã‚‚ã„ã„ã‚“ã§ã™ãŒã€åƒ•ã®å–ã‚Šæ‰±ã„ãŒè‰¯ããªã‹ã£ãŸã®ã‹ä»Šã¾ã§ï¼’å›ãã‚‰ã„ä¼¼ãŸã‚ˆã†ãªã“ã¨ãŒè¡Œã£ãŸã®ãŒï¼‘ã¤ç›®ã®ç†ç”±ã§ã™ã€‚

### 2. ãƒãƒ¼ãƒ ã§svnç’°å¢ƒã‹ã‚‰ã®è„±å´ã€€+ dockerã§ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã€€ã‚’å§‹ã‚ã‚‹è©±ãŒå‡ºãŸã€‚
ä»Šã¾ã§ä¼šç¤¾ã§ã¯svnç’°å¢ƒã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚’è¡Œãªã£ã¦ã„ãŸã“ã¨ã‚‚ã‚ã£ã¦ã€ãƒãƒ¼ãƒ ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¯ã¿ã‚“ãªã§å…±æœ‰ã—ã¦ã¾ã—ãŸã€‚
dockerã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¦ã¦é–‹ç™ºã‚’ãŠã“ãªã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä»Šã¾ã§ã‚„ã£ãŸã“ã¨ãŒãªã‹ã£ãŸã“ã¨ã‚‚ã‚ã‚Šã€å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã‚ˆã†ã¨æ€ã£ãŸã“ã¨ãŒdockerç§»è¡Œã‚’è¡Œã†ï¼’ã¤ç›®ã®ç†ç”±ã§ã™

## å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸
- å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ä»Šã¾ã§Herdã§é–‹ç™ºã—ã¦ã„ãŸã‚‚ã®ã‚’dockerã§ãƒ›ã‚¹ãƒˆã‚’ç«‹ã¦ã¦é–‹ç™ºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨
- sqlite->phpmyadminã§é‹ç”¨ãŒè¡Œãˆã‚‹ã“ã¨

ã§ã¯å®Ÿéš›ã«è¡Œã£ãŸãƒ•ãƒ­ãƒ¼ã‚’è¨˜è¼‰ã—ã¦ã„ãã¾ã™ï¼

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚
æ§‹æˆã¯ä¸€èˆ¬çš„ãªã‚‚ã®(ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒ„ã«ç½®ã„ã¦ã‚ã‚‹ã‚‚ã®)ã«æ²¿ã£ã¦ä½œæˆã‚’é€²ã‚ã¾ã—ãŸã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã¯ä»¥ä¸‹ã®è¦ç‚¹ã‚’æŠ¼ã•ãˆã¾ã—ã‚‡ãƒ¼
- è¨­å®šç³»ã¯ **docker/** ã«é›†ç´„ã•ã›ã‚‹ã“ã¨
- ãƒ«ãƒ¼ãƒˆç›´ä¸‹ã«ã€€**Dockerfile / docker-compose.yml**ã€€ã‚’ç½®ãã“ã¨

| å½¹è€… | ä½•ã‚’ã™ã‚‹ï¼Ÿ | ã‚¤ãƒ¡ãƒ¼ã‚¸ |
|------|-----------|----------|
| app | PHP(Laravel) ã‚’å®Ÿè¡Œ | `php:8.2-fpm` ã‚’è‡ªä½œãƒ“ãƒ«ãƒ‰ |
| nginx | ãƒªãƒãƒ—ãƒ­ + é™çš„é…ä¿¡ | `nginx:1.25-alpine` |
| db | MySQL 8 | `mysql:8.0` |
| phpmyadmin | GUI DB ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | `phpmyadmin/phpmyadmin` |

~~~
ZenFlow/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ nginx/default.conf
â”‚   â””â”€â”€ php/php.ini
â””â”€â”€ (Laravel ã®æ—¢å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)
~~~

## Dockerfile

Dockerfileã¯ã€€**ã‚³ãƒ³ãƒ†ãƒŠä½œæˆã‚’è¡Œã†æ‰‹é †æ›¸**ã¿ãŸã„ãªã‚‚ã®ã§ã™


ã©ã‚“ãªææ–™ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã‹
æº–å‚™ã‚’è¡Œã†æ‰‹é †
ã©ã†ã‚„ã£ã¦ä½œã£ã¦ã„ãã®ã‹
ã©ã†ã‚„ã£ã¦è¡¨ç¤ºãƒ»èµ·å‹•ã™ã‚‹ã®ã‹

ã¿ãŸã„ãªæ‰‹é †æ–¹æ³•ã‚’ã¾ã¨ã‚ã¦ãŠã„ã¦ãƒ“ãƒ«ãƒ‰ã™ã‚‹éš›ã«æ³¨æ–‡ã—ã¾ã™ã€‚
Dokerfileã‚’ä½œæˆã™ã‚‹éš›ã«èª¿ã¹ã¦ã¿ãŸã®ã§ã™ãŒã€è©³ç´°ã‚’èª¬æ˜ã™ã‚‹ã«ã¯åºƒã™ãã‚‹&æ·±ã™ãã¦ã“ã“ã§æ›¸ãå†…å®¹ã§ã¯ãªã„ã®ã§åˆ¥ã§ã¾ã¨ã‚ã¦å…±æœ‰ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼

ä¸€æ—¦åƒ•ã¯ä»¥ä¸‹ã®æ§‹æˆå†…å®¹ã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚
å‚™è€ƒ : ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ãŒMacã®äººã¯æ³¨æ„ã§ã™ã€‚ARM Mac(CPUãŒappleã‚·ãƒªã‚³ãƒ³ã®ã‚„ã¤) ã§ã¯liboing-dev ãŒãªã„ã¨mbstring ãŒã“ã‘ã‚‹ç½ ãŒå­˜åœ¨ã—ã¾ã™ï¼ï¼

~~~
FROM php:8.2-fpm

# --- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ---
RUN apt-get update && apt-get install -y \
    git curl zip unzip nodejs npm \
    libonig-dev libpng-dev libxml2-dev libzip-dev \
 && rm -rf /var/lib/apt/lists/*

# --- PHP æ‹¡å¼µ ---
RUN docker-php-ext-install pdo_mysql mbstring exif pcntl gd zip

# --- Composer ---
COPY --from=composer:latest /usr/bin/composer /usr/local/bin/composer

# --- ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼æ¨©é™ ---
RUN groupadd -g 1000 www && useradd -u 1000 -g www -m www
WORKDIR /var/www
COPY --chown=www:www . /var/www
RUN chown -R www:www storage bootstrap/cache

EXPOSE 9000
CMD ["php-fpm"]
~~~

## docker-compose.yml
### docker-compose.yml ã£ã¦ãªã‚ã«ï¼Ÿãªã‚“ã§å¿…è¦ãªã®ï¼Ÿ
**è¤‡æ•°ã®Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒ•ã‚¡ã‚¤ãƒ«** ã§ã™ï¼
ã•ã£ãDockerfileã‚’ä½œã‚Šã¾ã—ãŸã‚ˆã­ã€‚Dockerfileã¯ä¸€ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã®è¨­è¨ˆæ›¸ã£ã¦æ„Ÿã˜ãªã‚“ã§ã™ã€‚
ä»Šå›ã®å ´åˆã ã¨ã€Laravelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ã‚’å‹•ã‹ã™ã‚³ãƒ³ãƒ†ãƒŠ(PHPã¨webé¯–)ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹(mysql),Redisã ã£ãŸã‚Šã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã‹ã‚­ãƒ¥ãƒ¼ã‚’å‡¦ç†ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠãŒæœ€ä½é™å¿…è¦ã«ãªã‚Šã¾ã™ã€‚
ä¸Šè¨˜ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’å€‹åˆ¥ã«å‡¦ç†ã—ãŸã‚Šé€£æºã—ãŸã‚Šã™ã‚‹ã®ãŒ**docker-compose**ã®å½¹å‰²ã£ã¦ã“ã¨ã«ãªã‚Šã¾ã™
ä¸€ã¤ä¸€ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’æ‰‹å‹•ã§èµ·å‹•ã—ãŸã‚Šã™ã‚‹ã“ã¨ã¯ã§ãã‚‹ã¿ãŸã„ãªã‚“ã§ã™ãŒã‚ã‚“ã©ã„ã‚“ã§çµ¶å¯¾composeã‚’ä½¿ã£ãŸã»ã†ãŒã„ã„ã§ã™ã‚ˆã­

### YAML ã®ï¼“ã¤ã®ãƒ–ãƒ­ãƒƒã‚¯
1. **services:**    => ã‚³ãƒ³ãƒ†ãƒŠã‚’å®šç¾©ã™ã‚‹ã‚„ã¤
2. **networks:**ã€€  => ç›¸äº’é€šä¿¡ã•ã›ã‚‹æ©‹
3. **volumes:**     => ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ– 

- services
ã‚³ãƒ³ãƒ†ãƒŠã‚µãƒ¼ãƒ“ã‚¹ã‚’å®šç¾©ã™ã‚‹å ´æ‰€ã§ã™ï¼
ã‚µãƒ¼ãƒ“ã‚¹ãŒä½•ã§å‹•ã„ã¦ã„ã‚‹ã®ã‹ãŒã“ã“ã§åˆ†ã‹ã‚‹ã£ã¦ã„ã†ã®ã¨dockerç’°å¢ƒã‚’çµ±ä¸€ã•ã›ã‚‹ãŸã‚ã«ã“ã®è¨­å®šãŒã‚ã‚Šã¾ã™ï¼
- networks
ã‚³ãƒ³ãƒ†ãƒŠåŒå£«ãŒç›¸äº’ã«é€šä¿¡ã™ã‚‹ãŸã‚ã®æ©‹ã‚’è¨­å®šã—ã¾ã™
Dockerã¯å„ã‚³ãƒ³ãƒ†ãƒŠã§é›¢ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠã‚’éš”é›¢ã•ã‚ŒãŸç©ºé–“ã§å‹•ã‹ã™ã®ã§è¨­å®šã‚’ã—ãªã„ã¨ã‚¢ãƒ—ãƒªã®ã‚³ãƒ³ãƒ†ãƒŠã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®

~~~
services:
  app:
    build: .
    volumes:
      - .:/var/www
      - ./docker/php/php.ini:/usr/local/etc/php/conf.d/local.ini
    networks: [zenflow]

  nginx:
    image: nginx:1.25-alpine
    ports: ['8000:80']
    volumes:
      - .:/var/www
      - ./docker/nginx/default.conf:/etc/nginx/conf.d/default.conf
    depends_on: [app]
    networks: [zenflow]

  db:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: zenflow
      MYSQL_ROOT_PASSWORD: root
      MYSQL_USER: zenflow
      MYSQL_PASSWORD: password
    ports: ['3306:3306']
    volumes: [dbdata:/var/lib/mysql]
    networks: [zenflow]

  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    ports: ['8080:80']
    environment:
      PMA_HOST: db
      PMA_PORT: 3306
      MYSQL_ROOT_PASSWORD: root
    depends_on: [db]
    networks: [zenflow]

networks: {zenflow: {driver: bridge}}
volumes: {dbdata:}
~~~